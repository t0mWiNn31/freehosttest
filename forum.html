<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arakha Community</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <style>
        body { background: #0a0a0a; color: #ccc; font-family: sans-serif; margin: 0; }
        .nav { background: #111; padding: 15px; border-bottom: 1px solid #00ff41; display: flex; justify-content: space-between; position: sticky; top: 0; z-index: 100; }
        .container { max-width: 700px; margin: 20px auto; padding: 10px; }
        .post-input { background: #111; padding: 20px; border: 1px solid #333; margin-bottom: 20px; }
        input, textarea { width: 100%; background: #000; border: 1px solid #444; color: #fff; padding: 10px; margin-top: 10px; outline: none; }
        button { background: #00ff41; color: #000; border: none; padding: 10px 15px; cursor: pointer; font-weight: bold; margin-top: 10px; }
        .card { background: #161616; padding: 15px; border-radius: 5px; margin-bottom: 15px; border: 1px solid #222; }
        .user { color: #00ff41; font-weight: bold; font-size: 13px; }
        .title { font-size: 18px; color: #fff; margin: 10px 0; }
        .action-bar { border-top: 1px solid #222; padding-top: 10px; display: flex; gap: 20px; font-size: 13px; }
        .like-btn { cursor: pointer; color: #00ff41; }
    </style>
</head>
<body>

<div class="nav">
    <b style="color:#00ff41">ARAKHA_FORUM</b>
    <span id="user-display" style="font-size:12px"></span>
    <button onclick="logout()" style="background:#ff4444; color:#fff; padding:5px 10px; margin:0">LOGOUT</button>
</div>

<div class="container">
    <div class="post-input">
        <h3 style="margin:0; color:#00ff41">မေးချင်တာမေး ဆွေးနွေးချင်တာဆွေး</h3>
        <input type="text" id="t" placeholder="ခေါင်းစဉ်">
        <textarea id="c" rows="3" placeholder="အကြောင်းအရာ..."></textarea>
        <button onclick="post()">POST တင်မည်</button>
    </div>
    <div id="feed"></div>
</div>

<script>
    const config = {
        apiKey: "AIzaSyCpIv3avDNRYNrmrzKdMqfnMdNzBGZAPow",
        authDomain: "firstarakha.firebaseapp.com",
        projectId: "firstarakha",
        databaseURL: "https://firstarakha-default-rtdb.asia-southeast1.firebasedatabase.app",
        appId: "1:4263070909:web:ef4e4a2c0891be1f49bbd4"
    };
    firebase.initializeApp(config);
    const db = firebase.database();
    let currentUsername = "";

    firebase.auth().onAuthStateChanged(user => {
        if(!user) return window.location.href = "index.html";
        db.ref('users/' + user.uid).once('value', s => {
            currentUsername = s.val() ? s.val().username : user.email.split('@')[0];
            document.getElementById('user-display').innerText = "Logged in as: " + currentUsername;
            load();
        });
    });

    function post() {
        const t = document.getElementById('t').value, c = document.getElementById('c').value;
        if(t && c) {
            db.ref("posts").push({ u: currentUsername, t: t, c: c, likes: 0, time: Date.now() });
            document.getElementById('t').value = ""; document.getElementById('c').value = "";
        }
    }

    function load() {
        db.ref("posts").orderByChild("time").on("value", s => {
            const feed = document.getElementById('feed'); feed.innerHTML = "";
            let items = []; s.forEach(child => { items.push({key: child.key, ...child.val()}); });
            items.reverse().forEach(p => {
                feed.innerHTML += `
                <div class="card">
                    <div class="user">@${p.u}</div>
                    <div class="title">${p.t}</div>
                    <div style="font-size:14px">${p.c}</div>
                    <div class="action-bar">
                        <span class="like-btn" onclick="like('${p.key}', ${p.likes})">▲ Like (${p.likes})</span>
                        <span style="color:#888">Reply (Coming Soon)</span>
                    </div>
                </div>`;
            });
        });
    }

    function like(key, count) { db.ref("posts/" + key).update({ likes: count + 1 }); }

    function logout() {
        if(confirm("အကောင့်ထဲကနေ ထွက်မှာ သေချာလား ကိုကို?")) {
            firebase.auth().signOut().then(() => { window.location.href = "index.html"; });
        }
    }
</script>
</body>
</html>
